name: 'Container image scan'
description: 'Scan container images for vulnerabilities and CIS guidelines'
inputs: 
  image-name:
    description: 'Docker image to scan'
    required: true
  run-quality-checks:
    description: 'his is a boolean value. When set to `true` adds additional checks to ensure the image follows best practices and CIS standards.'
    default: 'true'
  severity-threshold:
    description: '(Optional) Minimum severity threshold set to control flagging of the vulnerabilities found during the scan. The available levels are: (UNKNOWN, LOW, MEDIUM, HIGH, CRITICAL); if you set the severity-threshold to be `MEDIUM` every CVE found of a level higher than or equal to `MEDIUM` would be displayed'
    required: false
    default: 'HIGH'
  username:
    description: 'Username to authenticate to the Docker registry'
    required: false
  password:
    description: 'Password to authenticate to the Docker registry'
    required: false
  token:
    description: 'Github token'
    default: ${{ github.token }}

outputs:
  scan-report-path:
    description: 'File path where the scan results are stored'

runs:
  using: 'node12'
  main: 'lib/main.js'